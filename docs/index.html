<!DOCTYPE html>
<html>
    <head>
        <style>
            * {
                font-family: sans-serif;
            }
            body {
                margin: 1em auto;
                max-width: 60em;
            }
        </style>

        <link href="https://cdn.jsdelivr.net/npm/simple-datatables@latest/dist/style.css" rel="stylesheet" type="text/css">
        <script src="https://cdn.jsdelivr.net/npm/simple-datatables@latest" type="text/javascript"></script>
    </head>
    <body>
        <h1>Specifications</h1>

        <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.

        <hr />

        <p>
            This repository contains specifications and standards drafted by finwo
            to enhance the quality of it's own produce, including, but not limited
            to, code, documents, workflows and products.
        </p>

        <p>
            Third parties are allowed to apply any of these specifications based on
            their own requirements.
        </p>

        <hr />

        <h3>Table of contents</h3>

        <table id=specTable>
            <thead>
                <tr>
                    <th>SPEC</th>
                    <th>Title</th>
                    <th>Obsoleted by</th>
                    <th>License</th>
                </tr>
            </thead>
            <tbody>
                <tr href="spec/0000.pdf">
                    <td>0000</td>
                    <td>Specification Format</td>
                    <td href='#q=0003'>0003</td>
                    <td href="license/cc-by-4.0.txt">CC-by-4.0</td>
                </tr>
                <tr href="spec/0001.pdf">
                    <td>0001</td>
                    <td>Javascript Styling</td>
                    <td></td>
                    <td href="license/cc-by-4.0.txt">CC-by-4.0</td>
                </tr>
                <tr href="spec/0002.pdf">
                    <td>0002</td>
                    <td>Ratus Unilicense</td>
                    <td></td>
                    <td href="license/cc-by-4.0.txt">CC-by-4.0</td>
                </tr>
                <tr href="spec/0003.pdf">
                    <td>0003</td>
                    <td>Specification Format</td>
                    <td></td>
                    <td href="license/cc-by-4.0.txt">CC-by-4.0</td>
                </tr>
            </tbody>
        </table>

        <script>

            // Query String handler
            const qs = {
                parse(str) {
                    let output    = {};
                    str.split('&').forEach(param => {
                        let [key, value] = param.split('=');
                        output[decodeURIComponent(key)] = decodeURIComponent(value);
                    });
                    return output;
                },
            };

            // Make the table nice and searchable
            const datatable = new simpleDatatables.DataTable('#specTable', {
                searchable: true
            });

            // Make all elements act as anchors when [href] is present
            Array.from(document.querySelectorAll('[href]')).forEach(node => {
                node.style.cursor = 'pointer';
                node.addEventListener('click', ev => {
                    ev.preventDefault();
                    let elem = ev.target;
                    while(!elem.attributes.href)
                        elem = elem.parentNode;
                    document.location.href = elem.attributes.href.value;
                });
            });

            // Hardwired data binding
            function onHashChange() {
                let q = qs.parse(document.location.hash.substr(1));
                if (q.q == datatable.input.value) return;
                datatable.input.value = q.q || '';
                datatable.search(q.q || '');
            };
            window.addEventListener('hashchange', onHashChange, false);
            datatable.on('datatable.search', query => {
                document.location.hash = '#q=' + query;
            });
            onHashChange();

        </script>
    </body>
</html>
